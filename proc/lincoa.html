<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="PowellOpt -- Optimization algorithms by M.J.D. Powell">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>lincoa &ndash; PowellOpt</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">PowellOpt </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>lincoa
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for procedures.">90 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/lincoa.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/lincoa.f90.html'>lincoa.f90</a></li>
    
     <li><a href='../module/lincoa_module.html'>lincoa_module</a></li>
    
  
     <li class="active">lincoa</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/lincoa.html#src">lincoa</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine lincoa(n, npt, m, a, ia, b, x, rhobeg, rhoend, iprint, maxfun, calfun)
    
    
   
</h2>
    
  


    
    <p>This subroutine seeks the least value of a function of many variables,
  subject to general linear inequality constraints, by a trust region
  method that forms quadratic models by interpolation.</p>
<p>LINCOA solves the following optimization problem:</p>
<div class="codehilite"><pre><span></span><code>   Minimize F(X(1),X(2),...X(N)) subject to:
   A * X &lt;= B
</code></pre></div>

<p>Usually there
  is much freedom in each new model after satisfying the interpolation
  conditions, which is taken up by minimizing the Frobenius norm of
  the change to the second derivative matrix of the model. One new
  function value is calculated on each iteration, usually at a point
  where the current model predicts a reduction in the least value so
  far of the objective function subject to the linear constraints.
  Alternatively, a new vector of variables may be chosen to replace
  an interpolation point that may be too far away for reliability, and
  then the new point does not have to satisfy the linear constraints.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n~26"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>the number of variables. must be at least 2.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-npt~15"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npt</strong></td><td><p>the number of interpolation conditions, which is
required to be in the interval [N+2,(N+1)(N+2)/2]. Typical choices
of the author are NPT=N+6 and NPT=2*N+1. Larger values tend to be
highly inefficent when the number of variables is substantial, due
to the amount of work and extra difficulty of adjusting more points.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m~5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>m</strong></td><td><p>the number of linear inequality constraints.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a~3"></span>real(kind=wp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(ia,*)</td><td>::</td>
  <td><strong>a</strong></td><td><p>a matrix whose columns are the constraint gradients, which are
required to be nonzero.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ia"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ia</strong></td><td><p>the first dimension of the array A, which must be at least N.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b~2"></span>real(kind=wp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>b</strong></td><td><p>the vector of right hand sides of the constraints, the J-th
constraint being that the scalar product of A(.,J) with X(.) is at
most B(J). The initial vector X(.) is made feasible by increasing
the value of B(J) if necessary.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x~15"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>x</strong></td><td><p>the vector of variables. Initial values of X(1),X(2),...,X(N)
must be supplied. If they do not satisfy the constraints, then B
is increased as mentioned above. X contains on return the variables
that have given the least calculated F subject to the constraints.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rhobeg~10"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhobeg</strong></td><td><p>RHOBEG and RHOEND must be set to the initial and final values of a
trust region radius, so both must be positive with RHOEND&lt;=RHOBEG.
Typically, RHOBEG should be about one tenth of the greatest expected
change to a variable, and RHOEND should indicate the accuracy that
is required in the final values of the variables.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rhoend~9"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rhoend</strong></td><td><p>RHOBEG and RHOEND must be set to the initial and final values of a
trust region radius, so both must be positive with RHOEND&lt;=RHOBEG.
Typically, RHOBEG should be about one tenth of the greatest expected
change to a variable, and RHOEND should indicate the accuracy that
is required in the final values of the variables.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iprint~11"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iprint</strong></td><td><p>The value of IPRINT should be set to 0, 1, 2 or 3, which controls the
amount of printing. Specifically, there is no output if IPRINT=0 and
there is output only at the return if IPRINT=1. Otherwise, the best
feasible vector of variables so far and the corresponding value of
the objective function are printed whenever RHO is reduced, where
RHO is the current lower bound on the trust region radius. Further,
each new value of F with its variables are output if IPRINT=3.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxfun~11"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxfun</strong></td><td><p>an upper bound on the number of calls of CALFUN,
its value being at least NPT+1.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-calfun~9"></span>procedure(<a href='../interface/func~5.html'>func</a>)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>calfun</strong></td><td><p>It must set
F to the value of the objective function for the variables X(1),
X(2),...,X(N). The value of the argument F is positive when CALFUN
is called if and only if the current X satisfies the constraints</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~lincoa~~CallsGraph Pages: 1 -->
<svg id="proclincoaCallsGraph" width="332pt" height="154pt"
 viewBox="0.00 0.00 332.00 154.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~lincoa~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 150)">
<title>proc~~lincoa~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-150 328,-150 328,4 -4,4"/>
<!-- proc~lincoa -->
<g id="proc~~lincoa~~CallsGraph_node1" class="node">
<title>proc~lincoa</title>
<polygon fill="none" stroke="black" points="54,-86 0,-86 0,-62 54,-62 54,-86"/>
<text text-anchor="middle" x="27" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50">lincoa</text>
</g>
<!-- proc~lincob -->
<g id="proc~~lincoa~~CallsGraph_node2" class="node">
<title>proc~lincob</title>
<g id="a_proc~~lincoa~~CallsGraph_node2"><a xlink:href=".././proc/lincob.html" xlink:title="lincob">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-86 90,-86 90,-62 144,-62 144,-86"/>
<text text-anchor="middle" x="117" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lincob</text>
</a>
</g>
</g>
<!-- proc~lincoa&#45;&gt;proc~lincob -->
<g id="proc~~lincoa~~CallsGraph_edge1" class="edge">
<title>proc~lincoa&#45;&gt;proc~lincob</title>
<path fill="none" stroke="#000000" d="M54.4,-74C62.39,-74 71.31,-74 79.82,-74"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-77.5 89.92,-74 79.92,-70.5 79.92,-77.5"/>
</g>
<!-- proc~prelim~2 -->
<g id="proc~~lincoa~~CallsGraph_node3" class="node">
<title>proc~prelim~2</title>
<g id="a_proc~~lincoa~~CallsGraph_node3"><a xlink:href=".././proc/prelim~2.html" xlink:title="prelim">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-146 180,-146 180,-122 234,-122 234,-146"/>
<text text-anchor="middle" x="207" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prelim</text>
</a>
</g>
</g>
<!-- proc~lincob&#45;&gt;proc~prelim~2 -->
<g id="proc~~lincoa~~CallsGraph_edge2" class="edge">
<title>proc~lincob&#45;&gt;proc~prelim~2</title>
<path fill="none" stroke="#000000" d="M135.81,-86.14C148.45,-94.76 165.63,-106.48 179.83,-116.16"/>
<polygon fill="#000000" stroke="#000000" points="177.98,-119.13 188.22,-121.88 181.93,-113.35 177.98,-119.13"/>
</g>
<!-- proc~trstep~2 -->
<g id="proc~~lincoa~~CallsGraph_node4" class="node">
<title>proc~trstep~2</title>
<g id="a_proc~~lincoa~~CallsGraph_node4"><a xlink:href=".././proc/trstep~2.html" xlink:title="trstep">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-66 180,-66 180,-42 234,-42 234,-66"/>
<text text-anchor="middle" x="207" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">trstep</text>
</a>
</g>
</g>
<!-- proc~lincob&#45;&gt;proc~trstep~2 -->
<g id="proc~~lincoa~~CallsGraph_edge3" class="edge">
<title>proc~lincob&#45;&gt;proc~trstep~2</title>
<path fill="none" stroke="#000000" d="M144.4,-68C152.48,-66.16 161.51,-64.11 170.1,-62.16"/>
<polygon fill="#000000" stroke="#000000" points="170.94,-65.56 179.92,-59.93 169.39,-58.73 170.94,-65.56"/>
</g>
<!-- proc~update~3 -->
<g id="proc~~lincoa~~CallsGraph_node5" class="node">
<title>proc~update~3</title>
<g id="a_proc~~lincoa~~CallsGraph_node5"><a xlink:href=".././proc/update~3.html" xlink:title="update">
<polygon fill="#d9534f" stroke="#d9534f" points="324,-127 270,-127 270,-103 324,-103 324,-127"/>
<text text-anchor="middle" x="297" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update</text>
</a>
</g>
</g>
<!-- proc~lincob&#45;&gt;proc~update~3 -->
<g id="proc~~lincoa~~CallsGraph_edge4" class="edge">
<title>proc~lincob&#45;&gt;proc~update~3</title>
<path fill="none" stroke="#000000" d="M144.26,-80.05C174.85,-87.09 225.55,-98.77 259.84,-106.67"/>
<polygon fill="#000000" stroke="#000000" points="259.39,-110.16 269.92,-108.99 260.96,-103.34 259.39,-110.16"/>
</g>
<!-- proc~qmstep -->
<g id="proc~~lincoa~~CallsGraph_node6" class="node">
<title>proc~qmstep</title>
<g id="a_proc~~lincoa~~CallsGraph_node6"><a xlink:href=".././proc/qmstep.html" xlink:title="qmstep">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 180,-24 180,0 234,0 234,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qmstep</text>
</a>
</g>
</g>
<!-- proc~lincob&#45;&gt;proc~qmstep -->
<g id="proc~~lincoa~~CallsGraph_edge5" class="edge">
<title>proc~lincob&#45;&gt;proc~qmstep</title>
<path fill="none" stroke="#000000" d="M135.39,-61.75C148.24,-52.69 165.96,-40.21 180.43,-30.01"/>
<polygon fill="#000000" stroke="#000000" points="182.79,-32.63 188.95,-24.01 178.76,-26.91 182.79,-32.63"/>
</g>
<!-- proc~prelim~2&#45;&gt;proc~update~3 -->
<g id="proc~~lincoa~~CallsGraph_edge6" class="edge">
<title>proc~prelim~2&#45;&gt;proc~update~3</title>
<path fill="none" stroke="#000000" d="M234.4,-128.3C242.48,-126.56 251.51,-124.61 260.1,-122.75"/>
<polygon fill="#000000" stroke="#000000" points="260.88,-126.16 269.92,-120.63 259.41,-119.32 260.88,-126.16"/>
</g>
<!-- proc~getact -->
<g id="proc~~lincoa~~CallsGraph_node7" class="node">
<title>proc~getact</title>
<g id="a_proc~~lincoa~~CallsGraph_node7"><a xlink:href=".././proc/getact.html" xlink:title="getact">
<polygon fill="#d9534f" stroke="#d9534f" points="324,-66 270,-66 270,-42 324,-42 324,-66"/>
<text text-anchor="middle" x="297" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">getact</text>
</a>
</g>
</g>
<!-- proc~trstep~2&#45;&gt;proc~getact -->
<g id="proc~~lincoa~~CallsGraph_edge7" class="edge">
<title>proc~trstep~2&#45;&gt;proc~getact</title>
<path fill="none" stroke="#000000" d="M234.4,-54C242.39,-54 251.31,-54 259.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="259.92,-57.5 269.92,-54 259.92,-50.5 259.92,-57.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~lincoa~~CalledByGraph Pages: 1 -->
<svg id="proclincoaCalledByGraph" width="168pt" height="32pt"
 viewBox="0.00 0.00 168.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~lincoa~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~lincoa~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 164,-28 164,4 -4,4"/>
<!-- proc~lincoa -->
<g id="proc~~lincoa~~CalledByGraph_node1" class="node">
<title>proc~lincoa</title>
<polygon fill="none" stroke="black" points="160,-24 106,-24 106,0 160,0 160,-24"/>
<text text-anchor="middle" x="133" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">lincoa</text>
</g>
<!-- proc~lincoa_test -->
<g id="proc~~lincoa~~CalledByGraph_node2" class="node">
<title>proc~lincoa_test</title>
<g id="a_proc~~lincoa~~CalledByGraph_node2"><a xlink:href=".././proc/lincoa_test.html" xlink:title="lincoa_test">
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lincoa_test</text>
</a>
</g>
</g>
<!-- proc~lincoa_test&#45;&gt;proc~lincoa -->
<g id="proc~~lincoa~~CalledByGraph_edge1" class="edge">
<title>proc~lincoa_test&#45;&gt;proc~lincoa</title>
<path fill="none" stroke="#000000" d="M70.12,-12C78.38,-12 87.24,-12 95.6,-12"/>
<polygon fill="#000000" stroke="#000000" points="95.84,-15.5 105.84,-12 95.84,-8.5 95.84,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/lincoa.html#src">lincoa</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">lincoa</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">npt</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rhobeg</span><span class="p">,</span> <span class="n">rhoend</span><span class="p">,</span> <span class="n">iprint</span><span class="p">,</span> <span class="n">maxfun</span><span class="p">,</span> <span class="n">calfun</span><span class="p">)</span>

        <span class="k">implicit none</span>

<span class="k">        </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">n</span>       <span class="c">!! the number of variables. must be at least 2.</span>
        <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">npt</span>     <span class="c">!! the number of interpolation conditions, which is</span>
                                                       <span class="c">!! required to be in the interval [N+2,(N+1)(N+2)/2]. Typical choices</span>
                                                       <span class="c">!! of the author are NPT=N+6 and NPT=2*N+1. Larger values tend to be</span>
                                                       <span class="c">!! highly inefficent when the number of variables is substantial, due</span>
                                                       <span class="c">!! to the amount of work and extra difficulty of adjusting more points.</span>
        <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">m</span>       <span class="c">!! the number of linear inequality constraints.</span>
        <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">ia</span>      <span class="c">!! the first dimension of the array A, which must be at least N.</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>       <span class="c">!! a matrix whose columns are the constraint gradients, which are</span>
                                                       <span class="c">!! required to be nonzero.</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">b</span>       <span class="c">!! the vector of right hand sides of the constraints, the J-th</span>
                                                       <span class="c">!! constraint being that the scalar product of A(.,J) with X(.) is at</span>
                                                       <span class="c">!! most B(J). The initial vector X(.) is made feasible by increasing</span>
                                                       <span class="c">!! the value of B(J) if necessary.</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>       <span class="c">!! the vector of variables. Initial values of X(1),X(2),...,X(N)</span>
                                                       <span class="c">!! must be supplied. If they do not satisfy the constraints, then B</span>
                                                       <span class="c">!! is increased as mentioned above. X contains on return the variables</span>
                                                       <span class="c">!! that have given the least calculated F subject to the constraints.</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">rhobeg</span>  <span class="c">!! RHOBEG and RHOEND must be set to the initial and final values of a</span>
                                                       <span class="c">!! trust region radius, so both must be positive with RHOEND&lt;=RHOBEG.</span>
                                                       <span class="c">!! Typically, RHOBEG should be about one tenth of the greatest expected</span>
                                                       <span class="c">!! change to a variable, and RHOEND should indicate the accuracy that</span>
                                                       <span class="c">!! is required in the final values of the variables.</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">rhoend</span>  <span class="c">!! RHOBEG and RHOEND must be set to the initial and final values of a</span>
                                                       <span class="c">!! trust region radius, so both must be positive with RHOEND&lt;=RHOBEG.</span>
                                                       <span class="c">!! Typically, RHOBEG should be about one tenth of the greatest expected</span>
                                                       <span class="c">!! change to a variable, and RHOEND should indicate the accuracy that</span>
                                                       <span class="c">!! is required in the final values of the variables.</span>
        <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">iprint</span>  <span class="c">!! The value of IPRINT should be set to 0, 1, 2 or 3, which controls the</span>
                                                       <span class="c">!! amount of printing. Specifically, there is no output if IPRINT=0 and</span>
                                                       <span class="c">!! there is output only at the return if IPRINT=1. Otherwise, the best</span>
                                                       <span class="c">!! feasible vector of variables so far and the corresponding value of</span>
                                                       <span class="c">!! the objective function are printed whenever RHO is reduced, where</span>
                                                       <span class="c">!! RHO is the current lower bound on the trust region radius. Further,</span>
                                                       <span class="c">!! each new value of F with its variables are output if IPRINT=3.</span>
        <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">maxfun</span>  <span class="c">!! an upper bound on the number of calls of CALFUN,</span>
                                                       <span class="c">!! its value being at least NPT+1.</span>
        <span class="k">procedure</span> <span class="p">(</span><span class="n">func</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">calfun</span>  <span class="c">!! It must set</span>
                                                       <span class="c">!! F to the value of the objective function for the variables X(1),</span>
                                                       <span class="c">!! X(2),...,X(N). The value of the argument F is positive when CALFUN</span>
                                                       <span class="c">!! is called if and only if the current X satisfies the constraints</span>

        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">zero</span> <span class="o">=</span> <span class="mf">0.0_wp</span>

        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">w</span>
        <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iact</span> <span class="c">!to avoid type mismatch error - JW</span>
        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">smallx</span><span class="p">,</span><span class="nb">sum</span><span class="p">,</span><span class="n">temp</span>
        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span><span class="n">nptm</span><span class="p">,</span><span class="n">iamat</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">iflag</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">iac</span><span class="p">,</span><span class="n">ibmat</span><span class="p">,</span><span class="n">ifv</span><span class="p">,</span><span class="n">igo</span><span class="p">,</span><span class="n">ihq</span><span class="p">,</span><span class="n">ipq</span><span class="p">,</span><span class="n">ipqw</span><span class="p">,&amp;</span>
                   <span class="n">iqf</span><span class="p">,</span><span class="n">irc</span><span class="p">,</span><span class="n">isp</span><span class="p">,</span><span class="n">istp</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">ixb</span><span class="p">,</span><span class="n">ixn</span><span class="p">,</span><span class="n">ixo</span><span class="p">,</span><span class="n">ixp</span><span class="p">,</span><span class="n">ixs</span><span class="p">,</span><span class="n">irf</span><span class="p">,</span><span class="n">izmat</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ndim</span>

<span class="c">!     W is an array used for working space. Its length must be at least</span>
<span class="c">!       M*(2+N) + NPT*(4+N+NPT) + N*(9+3*N) + MAX [ M+3*N, 2*M+N, 2*NPT ].</span>
<span class="c">!       On return, W(1) is set to the final value of F, and W(2) is set to</span>
<span class="c">!       the total number of function evaluations plus 0.5.</span>
        <span class="k">allocate</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">NPT</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="n">N</span><span class="o">+</span><span class="n">NPT</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">NPT</span><span class="p">)))</span>

<span class="c">!</span>
<span class="c">!     Check that N, NPT and MAXFUN are acceptable.</span>
<span class="c">!</span>
        <span class="n">smallx</span> <span class="o">=</span> <span class="mf">1.0e-6_wp</span> <span class="o">*</span> <span class="n">rhoend</span>
        <span class="n">np</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">nptm</span> <span class="o">=</span> <span class="n">npt</span> <span class="o">-</span> <span class="n">np</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            print </span><span class="mi">10</span>
<span class="mi">10</span>          <span class="k">format</span> <span class="p">(</span><span class="o">/</span> <span class="mi">4</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Return from LINCOA because N is less than 2.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">npt</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">+</span><span class="mi">2</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">npt</span> <span class="o">&gt;</span> <span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            print </span><span class="mi">20</span>
<span class="mi">20</span>          <span class="k">format</span> <span class="p">(</span><span class="o">/</span> <span class="mi">4</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Return from LINCOA because NPT is not in&#39;</span><span class="p">,&amp;</span>
            <span class="s1">&#39; the required interval.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">maxfun</span> <span class="o">&lt;=</span> <span class="n">npt</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            print </span><span class="mi">30</span>
<span class="mi">30</span>          <span class="k">format</span> <span class="p">(</span><span class="o">/</span> <span class="mi">4</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Return from LINCOA because MAXFUN is less&#39;</span><span class="p">,</span> <span class="s1">&#39; than NPT+1.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="c">!</span>
<span class="c">!     Normalize the constraints, and copy the resultant constraint matrix</span>
<span class="c">!       and right hand sides into working space, after increasing the right</span>
<span class="c">!       hand sides if necessary so that the starting point is feasible.</span>
<span class="c">!</span>
        <span class="n">iamat</span> <span class="o">=</span> <span class="nb">max</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">npt</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ib</span> <span class="o">=</span> <span class="n">iamat</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">iflag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">iw</span> <span class="o">=</span> <span class="n">iamat</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
                <span class="nb">sum</span> <span class="o">=</span> <span class="n">zero</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">zero</span>
                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
                    <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">a</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="n">a</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="k">end do</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">temp</span> <span class="o">==</span> <span class="n">zero</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    print </span><span class="mi">50</span>
<span class="mi">50</span>                  <span class="k">format</span> <span class="p">(</span><span class="o">/</span> <span class="mi">4</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Return from LINCOA because the gradient of&#39;</span><span class="p">,&amp;</span>
                    <span class="s1">&#39; a constraint is zero.&#39;</span><span class="p">)</span>
                    <span class="k">return</span>
<span class="k">                end if</span>
<span class="k">                </span><span class="n">temp</span> <span class="o">=</span> <span class="nb">sqrt</span> <span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">sum</span><span class="o">-</span><span class="n">b</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">smallx</span><span class="o">*</span><span class="n">temp</span><span class="p">)</span> <span class="n">iflag</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">w</span> <span class="p">(</span><span class="n">ib</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span> <span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="nb">sum</span><span class="p">)</span> <span class="o">/</span> <span class="n">temp</span>
                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
                    <span class="n">iw</span> <span class="o">=</span> <span class="n">iw</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">w</span> <span class="p">(</span><span class="n">iw</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="n">temp</span>
                <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">        end if</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">iflag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span><span class="n">iprint</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">print </span><span class="mi">70</span>
<span class="mi">70</span>          <span class="k">format</span> <span class="p">(</span><span class="o">/</span> <span class="mi">4</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;LINCOA has made the initial X feasible by&#39;</span><span class="p">,&amp;</span>
            <span class="s1">&#39; increasing part(s) of B.&#39;</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="c">!</span>
<span class="c">!     Partition the working space array, so that different parts of it can be</span>
<span class="c">!     treated separately by the subroutine that performs the main calculation.</span>
<span class="c">!</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="n">npt</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">ixb</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="n">m</span>
        <span class="n">ixp</span> <span class="o">=</span> <span class="n">ixb</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">ifv</span> <span class="o">=</span> <span class="n">ixp</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">npt</span>
        <span class="n">ixs</span> <span class="o">=</span> <span class="n">ifv</span> <span class="o">+</span> <span class="n">npt</span>
        <span class="n">ixo</span> <span class="o">=</span> <span class="n">ixs</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">igo</span> <span class="o">=</span> <span class="n">ixo</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">ihq</span> <span class="o">=</span> <span class="n">igo</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">ipq</span> <span class="o">=</span> <span class="n">ihq</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">ibmat</span> <span class="o">=</span> <span class="n">ipq</span> <span class="o">+</span> <span class="n">npt</span>
        <span class="n">izmat</span> <span class="o">=</span> <span class="n">ibmat</span> <span class="o">+</span> <span class="n">ndim</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">istp</span> <span class="o">=</span> <span class="n">izmat</span> <span class="o">+</span> <span class="n">npt</span> <span class="o">*</span> <span class="n">nptm</span>
        <span class="n">isp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">ixn</span> <span class="o">=</span> <span class="n">isp</span> <span class="o">+</span> <span class="n">npt</span> <span class="o">+</span> <span class="n">npt</span>
        <span class="n">iac</span> <span class="o">=</span> <span class="n">ixn</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">irc</span> <span class="o">=</span> <span class="n">iac</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">iqf</span> <span class="o">=</span> <span class="n">irc</span> <span class="o">+</span> <span class="n">m</span>
        <span class="n">irf</span> <span class="o">=</span> <span class="n">iqf</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">ipqw</span> <span class="o">=</span> <span class="n">irf</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="c">!</span>
<span class="c">!     The above settings provide a partition of W for subroutine LINCOB.</span>
<span class="c">!</span>
        <span class="k">call </span><span class="n">lincob</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">npt</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">(</span><span class="n">iamat</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ib</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">rhobeg</span><span class="p">,</span> <span class="n">rhoend</span><span class="p">,</span> <span class="n">iprint</span><span class="p">,</span> <span class="n">maxfun</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">ixb</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ixp</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ifv</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ixs</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ixo</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">igo</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ihq</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ipq</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">ibmat</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">izmat</span><span class="p">),</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">w</span><span class="p">(</span><span class="n">istp</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">isp</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ixn</span><span class="p">),</span> <span class="n">iact</span><span class="p">,</span> <span class="n">w</span><span class="p">(</span><span class="n">irc</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">w</span><span class="p">(</span><span class="n">iqf</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">irf</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">ipqw</span><span class="p">),</span> <span class="n">w</span><span class="p">,</span> <span class="n">calfun</span><span class="p">)</span>

        <span class="k">deallocate</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">lincoa</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>PowellOpt was developed by Jacob Williams<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>